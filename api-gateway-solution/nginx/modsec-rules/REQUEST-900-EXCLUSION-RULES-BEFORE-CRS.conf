# ModSecurity Rules to protect against perfctl malware

# Block perfctl malware
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS|REQUEST_BODY "@rx perfctl" \
    "id:9500000,phase:2,deny,status:403,log,msg:'Perfctl malware detected'"

# Block shell commands
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS|REQUEST_BODY "@rx (?:bin\/sh|wget http|curl http|bash)" \
    "id:9500001,phase:2,deny,status:403,log,msg:'Shell command detected'"

# Include the original exclusion rules file to maintain compatibility
Include /etc/modsecurity.d/owasp-crs/rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example
